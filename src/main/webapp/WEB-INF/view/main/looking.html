<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title>林区--找找看</title>
		<link rel="stylesheet" href="bootstrap/css/bootstrap.css" />
		<script type="text/javascript" src="js/jquery.js"></script>
		<script type="text/javascript" src="bootstrap/js/bootstrap.js"></script>
		<link rel="stylesheet" href="css/looking.css" />
		<script type="text/javascript" src="js/jquery.tmpl.js"></script>
		<script type="text/javascript" src="js/pages.js"></script>
		
		<!-- logo -->
		<link rel="icon" href="img/favicon.ico" type="image/x-icon">
	</head>

	<body>

		<div id="container1">
			<div class="head">
				<a href="main">« 返回博客</a>
			</div>

			<div class="main">
				<a href=""><img src="img/looking.png" /></a>
				<div class="input-group looking">
					<input type="text" class="form-control" />
					<span class="input-group-btn">
						<button type="button" class="btn btn-primary">找一下</button>
					</span>
				</div>
			</div>

			<div class="footer">
				©2017 小叶子
			</div>
		</div>

		<div id="container2">
			<div class="head">
				<a href="main">« 返回博客</a>
			</div>

			<div class="header">
				<div class="logo">
					<a href="looking"><img src="img/looking.png" /></a>
				</div>
				<div class="input-group looking2">
					<input type="text" class="form-control" />
					<span class="input-group-btn">
						<button type="button" class="btn btn-primary">找一下</button>
					</span>
				</div>
				<div class="clear">

				</div>
			</div>

			<div class="main">
				<div class="leftList">
					<div class="articals">
						<ul id="artUL">
							<!-- <li>
								<div class="artical">
									<div class="first">
										<a>这是文章标题一</a>
									</div>
									<div class="second">
										<span>房价快速复苏放缓法兰克哈哈斯科拉里客户法律身份卡斯卡拉防辐射拉芳舍辣椒粉哈发送健身房哈啊分哈哈来减肥减肥撒谎复活啦发挥了阿飞
										大打扫打扫空军联合发啦发挥就发生法律身份立法flak了发生类似纠纷哈发发将发挥了发掘发酵
										</span>
									</div>
									<div class="third">
										<a>小叶子</a>
										<span class="glyphicon glyphicon-time">2017-11-16</span>
										<span class="glyphicon glyphicon-copyright-mark">评论(2)</span>
										<span class="glyphicon glyphicon-share">浏览(100)</span>
									</div>
								</div>
							</li>
							<li>
								<div class="artical">
									<div class="first">
										<a>这是<span style="color: red;">文章</span>标题二</a>
									</div>
									<div class="second">
										<span>房价快速复苏放缓法兰克哈哈斯科拉里客户法律身份卡斯卡拉防辐射拉芳舍辣椒粉哈发送健身房哈啊分哈哈来减肥减肥撒谎复活啦发挥了阿飞
										大打扫打扫空军联合发啦发挥就发生法律身份立法flak了发生类似纠纷哈发发将发挥了发掘发酵
										</span>
									</div>
									<div class="third">
										<a>小叶子</a>
										<span class="glyphicon glyphicon-time">2017-11-16</span>
										<span class="glyphicon glyphicon-copyright-mark">评论(2)</span>
										<span class="glyphicon glyphicon-share">浏览(100)</span>
									</div>
								</div>
							</li>
							<li>
								<div class="artical">
									<div class="first">
										<a>这是<span style="color: red;">文章</span>标题二</a>
									</div>
									<div class="second">
										<span>房价快速复苏放缓法兰克哈哈斯科拉里客户法律身份卡斯卡拉防辐射拉芳舍辣椒粉哈发送健身房哈啊分哈哈来减肥减肥撒谎复活啦发挥了阿飞
										大打扫打扫空军联合发啦发挥就发生法律身份立法flak了发生类似纠纷哈发发将发挥了发掘发酵
										</span>
									</div>
									<div class="third">
										<a>小叶子</a>
										<span class="glyphicon glyphicon-time">2017-11-16</span>
										<span class="glyphicon glyphicon-copyright-mark">评论(2)</span>
										<span class="glyphicon glyphicon-share">浏览(100)</span>
									</div>
								</div>
							</li> -->
						</ul>
					</div>

					<div class="pages">
						<nav aria-label="Page navigation">
							<ul class="pagination">
								<li id="firstli">
									<a href="javascript:void(0);" onclick="">&laquo;</a>
								</li>
								<!--<li class="active page_item">
								<a href="javascript:void(0);" onclick="">1</a>
							</li>
							<li class="page_item">
								<a href="javascript:void(0);" onclick="">2</a>
							</li>
							<li class="page_item">
								<a href="javascript:void(0);" onclick="">3</a>
							</li>-->
								<li id="lastli">
									<a href="javascript:void(0);" onclick="">&raquo;</a>
								</li>
							</ul>
						</nav>
					</div>
				</div>
			</div>

			<div class="footer">
				©2017 小叶子
			</div>
		</div>
		
		
		<script type="text/x-jquery-tmpl" id="t1">
							<li>
								<div class="artical">
									<div class="first">
										<a href="blogRead?aid=${id}">{{html title}}</a>
									</div>
									<div class="second">
										{{html content}}......
									</div>
									<div class="third">
										<a href="blogPortal?uid=${uid}">${nickname}</a>
										<span class="glyphicon glyphicon-time">${pubTime}</span>
										<span class="glyphicon glyphicon-copyright-mark">评论(${commentNum})</span>
										<span class="glyphicon glyphicon-share">浏览(${viewNum})</span>
									</div>
								</div>
							</li>
		</script>

		<script type="text/javascript">
			
			var currentPage = 1;
			var totalPage = 30;
			
			var $getQueryString = function(name) {
				var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
				var r = window.location.search.substr(1).match(reg);
				if(r != null)
					return unescape(r[2]);
				return null;
			}
			
			var key = decodeURI($getQueryString("key"));

			$(function() {

				
				if(key != "null" && key !="") {
					$("#container1").css("display", "none");
					$("#container2").css("display", "block");
					$(".looking input").val("");
					$(".looking2 input").val(key);
					$getPageItems(key, 1);
				}else{
					$("#container1").css("display", "block");
					$("#container2").css("display", "none");
					$(".looking input").val("");
					$(".looking2 input").val("");
				}
			});
			
			var $getPageItems = function(condition,current){
				$.ajax({
					type : "get",
					url : "getSearchResult",
					dataType : "json",
					data : {
						current : current,
						condition : condition
					},
					async : true,
					success : function(data) {
						console.log(data);
						if(data.totalPages == 0){
							$("#artUL").html("&nbsp;&nbsp;<span style='font-size:16px;'>未查询到相关博客。</span>");
						}else{
							$("#t1").tmpl(data.oList).appendTo("#artUL");
							totalPage = data.totalPages;
							$getPages();
						}
					},
					error : function() {
						alert("数据获取失败");
					}
				});
			}

			$(".looking button").click(function() {
				var key = encodeURI(encodeURI($(".looking input").val()));
				window.location.href = "looking?key=" + key;
			});

			$(".looking2 button").click(function() {
				var key = encodeURI(encodeURI($(".looking2 input").val()));
				window.location.href = "looking?key=" + key;
			});

			
			/*自定义分页的逻辑*/
			$(function() {

				$(document).on(
						"click",
						".pagination li",
						function() {
							var current = $.trim($(this).text());
							if (current == "«") {
								var temp = $.trim($(".pagination li.active").prev()
										.text());
								if (temp != "«") {
									var $a = $(".pagination li.active");
									$(".pagination li.active")
											.removeClass("active");
									$a.prev().addClass("active");
									currentPage = parseInt($.trim($(
											".pagination li.active").text()));
									$(".page_item").remove();
									//$getPages();
									$("#artUL").empty();
									$getPageItems(key,currentPage);
								}
							} else if (current == "»") {
								var temp = $.trim($(".pagination li.active").next()
										.text());
								if (temp != "»") {
									var $a = $(".pagination li.active");
									$(".pagination li.active")
											.removeClass("active");
									$a.next().addClass("active");
									currentPage = parseInt($.trim($(
											".pagination li.active").text()));
									$(".page_item").remove();
									//$getPages();
									$("#artUL").empty();
									$getPageItems(key,currentPage);
								}
							} else if (current == "...") {

							} else {
								$(this).siblings("li").removeClass("active");
								$(this).addClass("active");
								currentPage = parseInt($.trim($(
										".pagination li.active").text()));
								$(".page_item").remove();
								//$getPages();
								$("#artUL").empty();
								$getPageItems(key,currentPage);
							}
						});

			});
			
		</script>
	</body>

</html>